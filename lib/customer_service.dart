import 'dart:convert';

import 'package:flutter_demo/models/api_response.dart';
import 'package:http/http.dart' as http;

import 'models/customer.dart';

class CustomerService {
  static String serverAddress = "https://boss-info-test-02.sandbox.operations.eu.dynamics.com/data/";

  static String cookie = "ms-dyn-affinity=AOS1; ms-dyn-csrftoken=mBnoZvQKvLbLrSeHmPApfA%3D%3D.n%2BiJfuy4v3CoVbqUmpc0uSt8RWCDc5TCjxH6u%2B4zO0TY983q2e63v4Nzi22AoPQcT0FxUqy%2F28RyhGyxJnQmOjTDY%2FwzCfj73vu167KgYWKeJhB3ZowIETesWe1yMCYY6ykwE3r91NpDyl0J21YVnrT1%2FjGA9pYjMZegqoFl17E7fgG9PsKBsDH5UDIAfL7thlVsGkunGDpn8FlK6%2Bnl%2BWddKoWst8dL3%2BhyG4%2BSMmXwQTsqKZ4ePyUNiAiFVUdEzK8E48g%2B5lp%2B2hvhAgKVSYukHxHVzORItSZo7uibrqL9Hp6V%2FmIzfi4vIuHOCTSM6Fids9B1C1ZVHGnSBaXbSQ%3D%3D; DynamicsOwinAuth=AAEAAFEVJcuO6EQNag2Qoc_5JIs4oEHxRER3IzaOJWoIUtMj0GKahjf_Zfn2VNODFI1OaVdOZdoG6DRit810E_y7IYLk5R9zf7xuO9w2UuhhcUjWFmuXtw-ZYJpAwCZDhoodMO7fpSDHM2qY-h8WXWYShyhV5R2ArMuovuHn3CX-XgcbVGyF2q4GUqec9SPhPWHbwG33OUCPJ7IL1OsL-pY6GRX7CFcOL_s1-uTl5ZVsS3KLGysNfQr7CZrUNWX6RwehXWv1qe0MV1V_rLo6Zuxf0ygwc1uMjGS8iry1IT3THxBzXbh2s1nAOEAMdz1KFy-BMgPD0iA5_0a26vomxdBvoURb1SWiSKHQv6MFXN1hE2VKD_Gy3yhNSf8NgWE-CzqaRQABAABO18I99BvRkxHXJY9h_MICJ6gdCCm8Ip-0hMWQ6vQ-J012De6rEDxGcyFyGkkhs2VPpg0w2WkpKrWKlXfmHBHqhWSXY9SQ2TxIsKR9Eu7KVBdnWHO2HAxRFBiKAGcHuAXaQQISPfQ15ZAI9yTc5K0QL-ebM_DalJZ20d8mojXEIW7dqtPvRt-EKRFUMDhXt35PCcQb6q5sdFg-Q_48B-CE50zZVMBbbNtc4HCVl8RWa4ay_z3mSuJGBe-cxPkqs9UiH0CUX00sOxiqoe88gV3Fee01CfzTfXLrfrecS_eJaszgU41zgrIqbbS4qPpAr-q32OdS-M9XNDqKPTRWNoBvkAcAAOzU6-X8LWv6MgpbcnZfelJGNnBJhqQszqEcnPZGpZ1C5azILOXyegtDaOXre5Bh3rokJG9lXnS8QjZ6CrSbPwPxDgAErzWJ64-1SuRzn2HiHpJZyYiFZIZOlFiiWFsf08-XOY3-jbn2ykgtwJeKXOIBAjrKygER_HTO-whHOteq31bSLGq9SD6GXPeF9tIH0qkLGL0rLyA5ke_maUfESyCFysGhEHvxCSC-SQ2cavFkgAbdLe2afM0raqNgACLA7AbLOaVq-_MGTNe4criFfRKCLNN3t3bIhuUlspsduMBeR7FVWDraL367Y8RK8oh1AcdO_-4evknhUUe9dxPIA5irzDhwJr9E2zLYu9h2uuAosGlBMhpNG_1T77IOdy4G6uM8HwtXHywUxKJ2n9-OFno4tW5cskvkSdZ7Kq6ucHS3BlXNmdhNNNJU-3NONiovxAXCmTlnLQH3bqcdTxTiXvHFwu7RBV-qhzY4RCvwEHtF5p9dFHutCUGP4TYb3WzoMkFApSIZUe5imibWGiYS0EyLlzd7UKeSxl_z-ydQPtvuao9BIr7FpWfP6o2Od33XJCDbQsW3mMXn4CsrdEpEW_cyyyavbJ9dZPFyqwsLiIlw8wsJslcUyV2uRn3F5EF4h-Gskk1oNNKOVm2PEtENG-JaZ-usnK7u2Dlf5KrEw3c1uMcpCl0W0xHCptMnqdQTNv8X1nB_2kWqGfArxIoU6UvOJqoF1knvq9PnSNXR87PzsA-wKxUQsyyeXn-TUhHvqJzb2ytNpEDp8MArriJVdQSAV12TcFcqC35MsHYAfiDnJgtQfHfvjkHoYQ1QtPrA10SVKMQUl8WNJvJjXnC9iTwvSVxDLY1pw__9jwg8LxiNWfrrThYQU1j9X00JlCMylwKcpgJOuxEHXRESy8xxNZtCL0UN5MgQOSJmzdH-VOzA8zGvaFquBSkPLVGOs7ITs0cz5amFpCKMKTpMtXoHTKJgfLCGCopiWrJamUM_9nOgjWo74lOxvSdjnx3KxbiuS0tQMcZrRncexzCj9bsEYQpnly--13CQYU9zftHo1TXyIzj64-fCrNhfLT0t9ltb_AO4Og0O6i97qkt_G22LREXXOnechpxhv_vTL-2PniK1J4x-2YMXvXTBEST9ZXzITLN-W2oboKSqXZ8b2raI3MG6ILD7teWXSM8-Px7IV6rEXdNr_LPkdVVLzE_NCY8vWFGzRJccGIurafyUXJ5d-5qKesv175JSMjW7ezaYFrunirWCgo_ePltQNXW7DBD7hu5AJUPrgn4GybBpU1QyIYS6g-LJ8W3ojsURpHhFDepTSPSoUklqXIkq3T5L3br4b9qdyBhqGK4NBWpGQTS968FX19KftZGhkKVuU1mc2B9tstKn2Q9uG4ni1QnCdfwdlxcB1MXk3cJQbsT8Hrlo0AFjc5-HuJU76bsKEW9i86Hn4w-ao3sXzarM1PwjPm1WIBM8ics4d4Uv-95Apk8eHnd3IgRP2Lhczkb5FQCOq-UZCCXI5uyXgNXx1VaA0CX8thEhhob0dKV_i8ZUalMjnYWU_ZiUQSmBB_36DVnJlP97beGj0cS6mpBUp1IWeJSUfXcmk2bdt2vh4jwrRbQr31m_rzxQLCLcuW7LDkvDkaeva-LsVZNz0pJ4nDJnJAKMPxto4EAj59kbgexhF7ZfFpZ959P63tGxHwXS7zai4rdEz2_yZ62dAT8wE3iz8JbCBdBywwsc7aPvLbHs0vKoUvBRpAKFNanl6rKPwPhhcFgY10h_bsxUz78CFDVw_DrJ8f-MFCCc_NL0a-8KH3LSkVePcJ4DYXJyCJdaCvoj7nXr5yLCHaE1V90KO6VxxOF5g8AI-5H98YrQmIiXgKgogIpeOibEcE1dfPZAxVJDxcTl35w3zaIFrbCQoVV-9eZGzfy0J20gFU-yjrZJZ445Od7jgIBd7gyZ7raHHb4OZg4Q_8nsMmdx2XbvDS5DoHe7FgaTbB-uHiYsDjie7cl2VXNNyHZLbAxBBb8xaSzM0hhM10A99ZzzMOaoxEmzS8aOuwYlZWLcYr2MH5ofLK3834Zmaa_9qJrO9bMt-QXlW_SynjqPHbFs91sb7B86IpBb3Dn0xSNIjWuw7Frv37i2sKUu2Qj1P82pQbKwZT6XZ3v2lhk_itvX4fCLOk6h7flnH3h1VYKSrFWgpJbJh-yILZALVf-QgKOkhLzoa-mqGoFrYGc2MSXvkWa9AyCxYjqXbQVw9i0bb7v8TZrWhBdgQDnc_tvS_ynIOk0rY8g6Q_37khy5VOc6V8N8XzCLjFVe3ovDVckWSEXM9ZexABZcA3L4c-GMMTipab-OGUPkWWMiheeXPF0q5F7gbX0JJAAZnHymEUYRc_qp_pFcO5ngKMy_skWAi5XIdvwBm2vQ7mRpJnKXIhvVWclIJ6M_1z_q3t_cYkCiFy2UAsCxqFeLm6eUkR_JhZFi7d3-UiBvt-aFAlw7jJXqCjlXwalcm-Io1atGsW1TZC3EtESvIR71OKzs5E8nvQSwKQAg2AxueCDyS1BD9I7Ag2v-HMNb9-PPujvMOmCHaFxQ_CpvnAv0Upw";

  static Future<List<Customer>> getCustomers() async {
    return httpGetResponse('CustomersV3');
  }

  static Future<List<Customer>> httpGetResponse(String apiURI) async {
    final http.Response response = await http.get(Uri.parse(serverAddress + apiURI), headers: {"Cookie": cookie});
    if (response.statusCode == 200) {
      var parsedResponse = ApiResponse.fromJson(json.decode(response.body));
      final List<Customer> customers = parsedResponse.value.map((personJson) => Customer.fromJson(personJson)).toList();
      return customers;
    } else {
      throw Exception('Failed to load customers');
    }
  }

}
